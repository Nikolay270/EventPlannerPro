@model IEnumerable<EventPlannerPro.Models.Category>
@using Microsoft.AspNetCore.Identity

@{
    ViewData["Title"] = "Categories";
    bool isAdmin = User.IsInRole("Admin");
}

<div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="mb-0">Categories</h2>
    @if (isAdmin)
    {
        <a asp-action="Create" class="btn btn-success">Create New Category</a>
    }
</div>

@if (!Model.Any())
{
    <p class="text-muted">No categories found.</p>
}
else
{
    <div class="row row-cols-1 row-cols-md-3 g-4">
        @foreach (var category in Model)
        {
            <div class="col">
                <div class="card h-100 text-center shadow-sm">
                    @if (!string.IsNullOrEmpty(category.PhotoUrl))
                    {
                        <img src="@category.PhotoUrl" alt="@category.Name" class="card-img-top" style="height:200px;object-fit:cover;" />
                    }
                    <div class="card-body d-flex flex-column">
                        <h5 class="card-title">@category.Name</h5>

                        <a asp-controller="Categories"
                           asp-action="Activities"
                           asp-route-id="@category.Id"
                           class="btn btn-outline-primary mb-2">
                            View Activities
                        </a>

                        @if (isAdmin)
                        {
                            <a asp-action="Edit" asp-route-id="@category.Id" class="btn btn-warning mb-2">Edit</a>

                            <form asp-action="Delete"
                                  asp-route-id="@category.Id"
                                  method="post"
                                  class="d-inline">
                                <button type="submit" class="btn btn-danger"
                                        onclick="return confirm('Are you sure you want to delete this category?');">
                                    Delete
                                </button>
                            </form>
                        }
                    </div>
                </div>
            </div>
        }
    </div>
}
